# @package _global_
test:
  topks:
    - 1
    - 3
    - 5
    - 10
    - 50
    - 100
  testfile: 0
  n_samples: 1
  batch_size: 32
  repeat_elbo: 1
  elbo_samples: 32
  full_dataset: false
  n_conditions: 8
  loss_0_repeat: 1
  chains_to_save: 1
  wandb_run_name: rxn_marginal_reactant_and_sn_dummy0_ce_clfgTrue
  with_denoising: true
  condition_first: 0
  condition_index: 0
  condition_steps: null
  plot_rxn_chains: true
  smiles_accuracy: true
  total_cond_eval: null
  plot_dummy_nodes: false
  size_test_splits: 100
  wandb_run_config: 2609_marginal_reactant_and_sn_dummy0_ce_clfgTrue_config.pickle
  sort_lambda_value: 0.9
  wandb_log_samples: true
  eval_before_first_epoch: false
  n_samples_per_condition: 100
  rep_samples_per_condition: 1

train:
  lr: 0.0002
  loss: ce
  seed: 2
  epochs: 1000
  amsgrad: true
  overfit: falsesac
  final_lr: 0.00001
  log_grad: false
  clip_grad: null
  ema_decay: 0
  optimizer: adamw
  size_bins:
    val:
      - 250
    test:
      - 250
    train:
      - 64
      - 83
      - 102
      - 140
  with_mask: false
  batch_size: 16
  initial_lr: 0.00001
  save_model: true
  log_every_t: 50
  num_workers: 0
  log_to_wandb: true
  lr_scheduler: none
  progress_bar: false
  weight_decay: 0.001
  batch_by_size: true
  batchsize_bins:
    val:
      - 32
    test:
      - 32
    train:
      - 16
      - 16
      - 16
      - 16
  chains_to_save: 4
  grad_every_step: 100
  eval_every_epoch: 20
  save_every_epoch: false
  num_warmup_epochs: 2
  save_models_at_all: true
  samples_to_generate: 4
  best_model_criterion: top-5
  num_annealing_epochs: 10
  resume: false
  resume_checkpoint_path: null

evaluate:
  checkpoint_path: null

dataset:
  name: uspto-50k
  datadir: data/uspto-50k
  shuffle: true
  remove_h: false
  size_bins:
    val:
      - 250
    test:
      - 250
    train:
      - 64
      - 83
      - 102
      - 140
  atom_types:
    - none
    - O
    - C
    - N
    - I
    - Cl
    - Si
    - F
    - Br
    - N+1
    - O-1
    - S
    - B
    - N-1
    - Zn+1
    - Cu
    - Sn
    - P+1
    - Mg+1
    - C-1
    - P
    - S+1
    - S-1
    - Se
    - Zn
    - Mg
    - U
    - Au
    - SuNo
  dataset_nb: block-15
  pin_memory: false
  num_workers: 0
  datadist_dir: data/uspto-50k
  dataset_size:
    val: 4951
    test: 4949
    train: 39811
  permute_mols: false
  allowed_bonds:
    B:
      - 3
    C:
      - 4
    F:
      - 1
    I:
      - 1
      - 3
      - 5
      - 7
    N:
      - 3
    O:
      - 2
    P:
      - 3
      - 5
      - 7
    S:
      - 2
      - 4
      - 6
    U:
      - 6
    Au:
      - 0
    Br:
      - 1
    Cl:
      - 1
    Cu:
      - 1
      - 2
    Mg:
      - 2
    Se:
      - 2
      - 4
      - 6
    Si:
      - 4
      - 6
    Sn:
      - 2
      - 4
    Zn:
      - 2
    C-1:
      - 3
    N+1:
      - 4
    N-1:
      - 2
    O-1:
      - 1
    P+1:
      - 4
      - 6
      - 8
    S+1:
      - 3
      - 5
      - 7
    S-1:
      - 1
      - 3
      - 5
    Mg+1:
      - 3
    Zn+1:
      - 3
  batchsize_bins:
    val:
      - 32
    test:
      - 32
    train:
      - 16
      - 16
      - 16
      - 16
  with_explicit_h: false
  nb_rct_dummy_nodes: 15
  with_formal_charge: true
  add_supernode_edges: true
  canonicalize_molecule: true
  atom_charges:
    - +
    - -
    - 0
  use_stereochemistry: false

general:
  gpus: 1
  name: rxn_absorbing_masknoedge_dummy15_loss_ce_laplacian_pos_encnum_gpus_1_fancybatching_16_diffusionsteps500_num_ev_20_p_to_r_skipinput_alignment_correct_wd0.001_drop0.2-seed2
  task: rxn
  wandb:
    mode: online
    tags:
      - default
    group: default
    entity: najwalb
    nfiles: null
    resume: false
    run_id: null
    project: retrodiffuser
    run_name: null
    load_run_config: null
    sample_file_name: null
    checkpoint_epochs: null
    eval_sampling_steps: null
  project: retrodiffuser
  wandb_id: null
  log_every_steps: 50
  resume_from_last_n: 1

diffusion:
  denoiser: neuralnet
  ce_lambda: 2
  mask_edges: product_and_sn
  mask_nodes: product_and_sn
  transition: absorbing_masknoedge
  lambda_test: 1
  lambda_train:
    - 5
    - 0
  diffuse_edges: true
  diffuse_nodes: true
  extra_features: true
  num_node_steps: 1
  diffusion_steps: 500
  edge_states_to_mask:
    - mol
    - within
    - across
  node_states_to_mask:
    - SuNo
    - none
  diffusion_steps_eval: 100
  edge_conditional_set: val
  classifier_free_guidance: false
  diffusion_noise_schedule: cosine
  temperature_scaling_edge: 1
  temperature_scaling_node: 1
  classifier_free_uncond_prob: 0.1
  classifier_free_guidance_weight: 0.1
  classifier_free_drop_within_batch: false
  classifier_free_full_unconditioning: false

neuralnet:
  dropout: 0.2
  use_ema: false
  improved: false
  n_layers: 9
  ema_decay: 0.999
  hidden_dims:
    de: 64
    dx: 256
    dy: 64
    n_head: 8
    dim_ffE: 128
    dim_ffX: 256
    dim_ffy: 128
  p_to_r_init: 1
  architecture: with_y_atommap_number_pos_enc
  #architecture: with_y_atommap_number_pos_enc_stereo
  use_all_gpus: true
  alignment_type: correct
  extra_features: true
  checkpoint_file: null
  hidden_mlp_dims:
    E: 128
    X: 256
    y: 128
  input_alignment: false
  load_checkpoint: false
  pos_encoding_type: laplacian_pos_enc
  num_lap_eig_vectors: 20
  pos_emb_permutations: -1
  atom_map_pos_encoding: false
  p_to_r_skip_connection: true
  increase_y_dim_for_multigpu: true

experiment_group: 7ckmnkvc